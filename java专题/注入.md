
# java  

两个靶场，javasec   

  配置注意。

 cors跨域资源共享--太鸡肋了，危害较低。

java里面操作数据库的。





​			

### jdbc

java里面的sql注入代审，语句拼接。危险写法和安全写法。原生态的。	

1看有没有用这两个方法，2看有没有使用下面的安全写法。有1无2，那就可以尝试jdbc注入

![image-20250313105542095](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621143.png)

![image-20250316162002335](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621144.png)



### mybatis

   就是java里的数据库操作。常用的。

1看是不是用$  2看是不是用order by 、like 、in 这些语句

![image-20250313105526019](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621145.png)s

java里面看sql是否有sql注入，那么就看是mybatis还是jdbc，然后看是$# 这些字符，预编译字符，进行排查有没有一些拼接之类的。

![image-20250316162118831](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621146.png)

![image-20250316163730713](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621147.png)

搭建靶场  java的网校靶场

黑盒就是，点测

白盒：先看pom.xml  看是用的jdbc还是mybatis来处理数据操作（还有以一个hibernate），这三个都是java里面操作数据库的。关注$#这些， 搜${   或者%${     或者   （${	主要还是$符号  然后不看jsp这些html带啊吗，关注java

#为安全写法，主要关注点位$不安全写法：

先打开源码发现有引用mybatis，然后猜测有没有引用sql的不安全写法。2、发现存在，这里一般不关注jsp，这类静态文件	3、定位到变量	4、看引用的id为什么，继续向上查找引用id的路由。

![image-20250316171025831](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621148.png)

1、查找引用id的	2、关注一些controller文件	3、定位	4、在delete模块	5、admin路径（路由）下

![image-20250316171604874](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621149.png)

  分析发现可能存在sql注入，用sqlmap跑

找到了对应路由，这里不能直接访问，是找出来的，根据上面的delete提醒找到：

![image-20250316172602846](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621150.png)

将抓到的数据包测试，在将发送的articelid参数注入点加上，直接就sqlmap跑、：

![image-20250316172713462](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621151.png)

这里注意：复制数据包时候是选原始在复制：

![image-20250316173006826](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621152.png) 

### xml实体注入：

![image-20250313114852083](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621153.png)



![image-20250316175551721](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621154.png)

黑盒就是看数据包是不是xml格式，然后插入dns外带试一下。



### SSTI模板注入

SSTI模版         spring boot 框架的。不同框架。	ognl jstl  是一些过时框架的。	ssti的几个可能有漏洞的模板

![image-20250316181357681](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621155.png)

 就是模板，将别人的模板中的参数，插入自己的语句，然后实现rce。就比如有的页面，lang=en 然后就是英文页面，lang=cn  就是中文页面，这时候你就尝试改lang后面的参数，看能不能实现rce

参数就是让你渲染别的页面，这页面就是模板，参数可以替换成自己的命令,实现rce。lang参数直接改之类的。

![image-20250316181046474](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621156.png)



![image-20250316181105952](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621157.png)

### SPEL表达式注入

SPEL表达式	ognl表达式注入(老了)	spel就好比php中的eval	java特有的

![image-20250312223141711](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621158.png)

![image-20250316181842919](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621159.png)

绕过黑名单：

利用反射机制的方法。--- forname   getclass	这些方法。

![image-20250316182734435](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161621160.png)
